cmake_minimum_required(VERSION 3.11)
project(OmniThing)

option(BUILD_LINUX "Build for a generic linux target" OFF)
option(BUILD_RPI "Build for a raspberry pi linux target" OFF)
option(BUILD_ARDUINO "Create directory structure for Arduino IDE" OFF)

file(GLOB_RECURSE sources_core src/core/*.cpp src/core/*.c)
file(GLOB_RECURSE sources_linux src/linux/lib/*.cpp)
file(GLOB_RECURSE sources_rpi src/raspberry_pi/lib/*.cpp)
file(GLOB_RECURSE sources_arduino src/arduino/lib/*.cpp)

if(BUILD_LINUX)
    add_executable(OmniThing src/linux/OmniThing.cpp ${sources_core} ${sources_linux})
    include_directories(include/core)
    include_directories(include/linux/lib)
elseif(BUILD_RPI)
    add_executable(OmniThing src/raspberry_pi/OmniThing.cpp ${sources_core} ${sources_linux} ${sources_rpi})
    include_directories(include/core)
    include_directories(include/linux/lib)
    include_directories(include/raspberry_pi/lib)
    find_package(pigpio)
endif()

unset(BUILD_LINUX CACHE)
unset(BUILD_RPI CACHE)
unset(BUILD_ARDUINO CACHE)
